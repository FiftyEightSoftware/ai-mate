# Deploy AI Mate to Render - Step by Step

## Prerequisites Checklist
- ‚úÖ Code is working locally (backend + frontend tested)
- ‚úÖ Tests passing (86% pass rate)
- ‚úÖ Database seeded with realistic data
- ‚è≥ GitHub account (you'll need this)
- ‚è≥ Render account (free - https://render.com)

---

## Step 1: Create GitHub Repository

### Option A: Using GitHub CLI (Fastest)
```bash
# Install GitHub CLI if you don't have it
brew install gh

# Login to GitHub
gh auth login

# Create repository and push
gh repo create ai-mate --public --source=. --remote=origin --push
```

### Option B: Using GitHub Web Interface
1. Go to https://github.com/new
2. Repository name: `ai-mate` (or any name you prefer)
3. Choose **Public** or **Private**
4. **Do NOT** initialize with README (we already have code)
5. Click "Create repository"

Then run these commands:
```bash
cd "/Users/nickphinesme.com/Developer/AI Mate"

# Add all new files
git add .

# Commit changes
git commit -m "Add integration tests and prepare for deployment"

# Add GitHub remote (replace YOUR-USERNAME)
git remote add origin https://github.com/YOUR-USERNAME/ai-mate.git

# Push to GitHub
git branch -M main
git push -u origin main
```

---

## Step 2: Deploy to Render

### Using Render Dashboard (Recommended)

1. **Go to Render**: https://dashboard.render.com/

2. **Sign Up / Log In**
   - Use GitHub account for easiest integration
   - Free tier is sufficient to start

3. **Create New Blueprint**
   - Click "New +" ‚Üí "Blueprint"
   - Or go directly to: https://dashboard.render.com/select-repo

4. **Connect Repository**
   - Click "Connect" next to your GitHub account
   - Authorize Render to access your repositories
   - Select the `ai-mate` repository

5. **Apply Blueprint**
   - Render will automatically detect `render.yaml`
   - Review the services it will create:
     - ‚úÖ **ai-mate-api** (Backend)
     - ‚úÖ **ai-mate-redis** (Cache)
     - ‚úÖ **ai-mate-frontend** (Frontend)
   
6. **Set Environment Variables** (if needed)
   - `AIMATE_DB_PASSWORD` - Auto-generated by Render
   - `REDIS_CONNECTION` - Auto-linked from Redis service
   - `FRONTEND_ORIGINS` - Will be auto-set to your Render domain

7. **Click "Apply"**
   - Render will start building and deploying
   - This takes **5-10 minutes** for first deployment

8. **Monitor Deployment**
   - Watch the build logs in real-time
   - Backend will build Docker image
   - Frontend will build static site
   - Services will start automatically

---

## Step 3: Verify Deployment

### Check Backend Health
Once deployed, Render will give you a URL like: `https://ai-mate-api.onrender.com`

Test the backend:
```bash
# Replace with your actual Render URL
BACKEND_URL="https://ai-mate-api.onrender.com"

# Health check
curl $BACKEND_URL/api/health | jq

# Should return:
# {
#   "ok": true,
#   "status": "Healthy",
#   "checks": [...]
# }

# Test dashboard endpoint
curl $BACKEND_URL/api/dashboard | jq '.outstandingTotal'

# Test invoices
curl $BACKEND_URL/api/invoices | jq 'length'
```

### Check Frontend
Your frontend URL will be like: `https://ai-mate-frontend.onrender.com`

1. Open in browser
2. Should see the AI Mate dashboard
3. Check browser console for errors
4. Test navigation to different pages

---

## Step 4: Post-Deployment Configuration

### Update Frontend to Use Production API

The `render.yaml` already configures this, but verify:

1. **Check API Proxy**
   - Frontend should proxy `/api/*` requests to backend
   - Configured in `render.yaml` routes section

2. **CORS Configuration**
   - Backend `FRONTEND_ORIGINS` should include your frontend URL
   - Render auto-configures this via `render.yaml`

3. **Database Seeding**
   - First startup will seed the database automatically
   - Check logs to confirm: "Seeding database..."

---

## Troubleshooting

### Build Fails

**Check build logs** in Render dashboard:

**Common issues:**
- Missing `.NET 8 SDK` ‚Üí Should be in Dockerfile
- Missing `Node.js` ‚Üí Should be detected automatically
- Environment variables not set ‚Üí Check Render dashboard

**Solution:**
1. Click on failed service
2. Go to "Logs" tab
3. Find the error message
4. Fix in code and push to GitHub
5. Render auto-deploys on git push

### Backend Returns 500 Errors

**Check:**
```bash
# View backend logs in Render dashboard
# Look for database or Redis connection errors
```

**Common fixes:**
- Ensure `AIMATE_DB_PASSWORD` is set
- Check Redis connection is working
- View logs for specific error messages

### Frontend Can't Connect to Backend

**Check:**
1. Backend health endpoint returns 200
2. CORS is configured correctly
3. API proxy routes are working
4. Browser console for network errors

**Fix:**
```yaml
# In render.yaml, ensure routes are correct:
routes:
  - type: rewrite
    source: /api/*
    destination: https://ai-mate-api.onrender.com/api/:splat
```

### Database Not Seeding

**Check logs for:**
```
[INFO] Seeding database...
```

**If missing:**
- Database migrations may have failed
- Check `AIMATE_DB_PASSWORD` is set
- View backend logs for SQLite errors

---

## Monitoring Your Deployment

### Health Checks
Render automatically monitors your `/api/health` endpoint.

### Logs
- Click on any service in Render dashboard
- Go to "Logs" tab
- Real-time log streaming
- Search and filter available

### Metrics
Access your metrics endpoint:
```bash
curl https://your-api.onrender.com/api/metrics | jq
```

### Performance
Render free tier:
- **750 hours/month** compute time
- **100GB bandwidth**
- **Sleeps after 15min inactivity**
- **Wakes on first request** (~30s cold start)

---

## Upgrading from Free Tier

When you're ready for production:

### Starter Plan ($7/month per service)
- No sleep
- Always-on
- Better performance
- More resources

### To Upgrade:
1. Go to service in Render dashboard
2. Click "Upgrade"
3. Select "Starter" plan
4. Update billing

---

## Continuous Deployment

### Automatic Deploys
Render automatically deploys when you push to GitHub:

```bash
# Make changes
git add .
git commit -m "Update feature"
git push origin main

# Render automatically:
# 1. Detects push
# 2. Builds new version
# 3. Deploys with zero downtime
# 4. Rolls back if health check fails
```

### Manual Deploy
In Render dashboard:
1. Click on service
2. Click "Manual Deploy"
3. Select branch
4. Click "Deploy"

---

## Cost Estimate

### Free Tier (Perfect for Testing)
- **Backend**: Free (sleeps after 15min)
- **Redis**: Free starter plan
- **Frontend**: Free (static hosting)
- **Total**: $0/month

### Production Ready
- **Backend**: $7/month (Starter plan)
- **Redis**: $10/month (Standard plan)
- **Frontend**: $0 (static hosting remains free)
- **Total**: $17/month

### At Scale (1000+ users)
- **Backend**: $25/month (Standard plan)
- **Redis**: $50/month (Pro plan)
- **Frontend**: $0
- **Total**: $75/month

---

## Next Steps After Deployment

1. ‚úÖ **Set up custom domain** (optional)
   - Add domain in Render dashboard
   - Update DNS records
   - Free SSL certificate included

2. ‚úÖ **Configure alerts**
   - Set up error notifications
   - Monitor uptime
   - Track response times

3. ‚úÖ **Enable backups** (recommended)
   - Database backup strategy
   - Consider external backup service

4. ‚úÖ **Performance monitoring**
   - Use `/api/metrics` endpoint
   - Set up Application Insights (optional)
   - Monitor user experience

5. ‚úÖ **Security hardening**
   - Review CORS settings
   - Check rate limiting
   - Enable HTTPS-only

---

## Support Resources

- **Render Docs**: https://render.com/docs
- **Render Community**: https://community.render.com
- **Your Health Check**: `https://your-api.onrender.com/api/health`
- **Your Metrics**: `https://your-api.onrender.com/api/metrics`

---

## Quick Reference Commands

```bash
# After initial setup, deploying updates is just:
git add .
git commit -m "Your update message"
git push origin main

# That's it! Render does the rest automatically.
```

**Deployment complete! üéâ**
