(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))s(i);new MutationObserver(i=>{for(const o of i)if(o.type==="childList")for(const a of o.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&s(a)}).observe(document,{childList:!0,subtree:!0});function t(i){const o={};return i.integrity&&(o.integrity=i.integrity),i.referrerPolicy&&(o.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?o.credentials="include":i.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function s(i){if(i.ep)return;i.ep=!0;const o=t(i);fetch(i.href,o)}})();"serviceWorker"in navigator&&window.addEventListener("load",()=>{navigator.serviceWorker.register("/sw.js").catch(n=>{console.warn("SW registration failed",n)})});class h{constructor(){this.container=null,this.init()}init(){this.container||(this.container=document.createElement("div"),this.container.className="toast-container",document.body.appendChild(this.container))}show(e,t="info",s=3e3){const i=document.createElement("div");i.className=`toast ${t}`;const o={success:"✓",error:"✕",info:"ℹ"};return i.innerHTML=`
      <span class="toast-icon">${o[t]||"ℹ"}</span>
      <span class="toast-message">${e}</span>
      <button class="toast-close" aria-label="Close">×</button>
    `,this.container.appendChild(i),i.querySelector(".toast-close").addEventListener("click",()=>this.remove(i)),s>0&&setTimeout(()=>this.remove(i),s),i}remove(e){e.style.animation="toastSlide 0.3s reverse",setTimeout(()=>{e.parentNode&&e.parentNode.removeChild(e)},300)}success(e,t){return this.show(e,"success",t)}error(e,t){return this.show(e,"error",t)}info(e,t){return this.show(e,"info",t)}}const r=new h;class u{constructor(){this.banner=null,this.init()}init(){window.addEventListener("online",()=>this.handleOnline()),window.addEventListener("offline",()=>this.handleOffline()),navigator.onLine||this.handleOffline()}handleOffline(){this.banner||(this.banner=document.createElement("div"),this.banner.className="offline-banner",this.banner.textContent="📡 You are offline. Some features may be limited.",document.body.insertBefore(this.banner,document.body.firstChild)),r.info("You are offline",0)}handleOnline(){this.banner&&(this.banner.style.animation="slideDown 0.3s reverse",setTimeout(()=>{this.banner&&this.banner.parentNode&&(this.banner.parentNode.removeChild(this.banner),this.banner=null)},300)),r.success("Back online!",2e3)}}new u;class m{constructor(){this.recognition=null,this.isRecording=!1,this.transcript=[],this.init()}init(){if("webkitSpeechRecognition"in window||"SpeechRecognition"in window){const e=window.SpeechRecognition||window.webkitSpeechRecognition;this.recognition=new e,this.recognition.continuous=!1,this.recognition.interimResults=!0,this.recognition.lang="en-US",this.recognition.onresult=t=>this.handleResult(t),this.recognition.onerror=t=>this.handleError(t),this.recognition.onend=()=>this.handleEnd()}}start(){if(!this.recognition){r.error("Speech recognition not supported in this browser");return}if(!this.isRecording)try{this.recognition.start(),this.isRecording=!0,this.updateUI(!0)}catch(e){console.error("Speech recognition error:",e),r.error("Could not start speech recognition")}}stop(){this.recognition&&this.isRecording&&this.recognition.stop()}handleResult(e){const t=e.results[e.results.length-1],s=t[0].transcript,i=document.querySelector(".transcript");i&&(i.textContent=s),t.isFinal&&(this.addToHistory(s),this.processCommand(s))}handleError(e){console.error("Speech recognition error:",e.error),e.error==="no-speech"?r.info("No speech detected. Please try again."):e.error==="not-allowed"?r.error("Microphone permission denied"):r.error("Speech recognition error: "+e.error),this.isRecording=!1,this.updateUI(!1)}handleEnd(){this.isRecording=!1,this.updateUI(!1)}updateUI(e){const t=document.querySelector(".mic-button");t&&(e?(t.classList.add("pulse"),t.innerHTML="🔴 Recording..."):(t.classList.remove("pulse"),t.innerHTML="🎙️ Hold to Speak"))}addToHistory(e){const t=new Date().toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"});this.transcript.unshift({time:t,text:e}),this.transcript.length>10&&(this.transcript=this.transcript.slice(0,10)),this.renderHistory()}renderHistory(){let e=document.querySelector(".transcript-history");if(!e){e=document.createElement("div"),e.className="transcript-history";const t=document.querySelector(".assistant");t&&t.appendChild(e)}e.innerHTML=this.transcript.map(t=>`
      <div class="transcript-item">
        <div class="transcript-time">${t.time}</div>
        <div class="transcript-text">${t.text}</div>
      </div>
    `).join("")}processCommand(e){const t=e.toLowerCase();t.includes("show")||t.includes("go to")||t.includes("open")?t.includes("job")?this.navigateTo("/pages/jobs.html","Jobs"):t.includes("client")?this.navigateTo("/pages/clients.html","Clients"):t.includes("invoice")?this.navigateTo("/pages/invoices.html","Invoices"):t.includes("home")?this.navigateTo("/pages/home.html","Home"):t.includes("setting")&&this.navigateTo("/pages/settings.html","Settings"):r.info("Command recognized: "+e)}navigateTo(e,t){htmx.ajax("GET",e,{target:"#content",swap:"innerHTML"}),document.getElementById("title").textContent=t,history.pushState({},t,e),r.success(`Opening ${t}`)}}const l=new m;class f{constructor(e){this.searchInput=document.querySelector(e),this.searchInput&&this.init()}init(){this.searchInput.addEventListener("input",t=>this.handleSearch(t));const e=this.searchInput.parentElement.querySelector(".search-clear");e&&e.addEventListener("click",()=>{this.searchInput.value="",this.handleSearch({target:this.searchInput})})}handleSearch(e){const t=e.target.value.toLowerCase();document.querySelectorAll(".list-item, .card").forEach(i=>{i.textContent.toLowerCase().includes(t)?i.style.display="":i.style.display="none"})}}class c{static save(e,t){try{return localStorage.setItem(`aiMate_${e}`,JSON.stringify(t)),!0}catch(s){return console.error("Storage error:",s),!1}}static load(e){try{const t=localStorage.getItem(`aiMate_${e}`);return t?JSON.parse(t):null}catch(t){return console.error("Storage error:",t),null}}static remove(e){localStorage.removeItem(`aiMate_${e}`)}}class g{constructor(){this.currentTheme=c.load("theme")||"auto",this.apply()}toggle(){const e=["auto","light","dark"],t=e.indexOf(this.currentTheme);this.currentTheme=e[(t+1)%e.length],this.apply(),c.save("theme",this.currentTheme),r.success(`Theme: ${this.currentTheme}`)}apply(){const e=document.documentElement;this.currentTheme==="light"?e.style.colorScheme="light":this.currentTheme==="dark"?e.style.colorScheme="dark":e.style.colorScheme=""}}const d=new g;document.body.addEventListener("htmx:afterSwap",n=>{if(n.target.id==="content"){n.target.querySelector(".search-input")&&new f(".search-input");const t=n.target.querySelector(".mic-button");t&&!t.dataset.initialized&&(t.dataset.initialized="true",t.addEventListener("click",()=>l.start()));const s=n.target.querySelector('[data-action="toggle-theme"]');s&&!s.dataset.initialized&&(s.dataset.initialized="true",s.addEventListener("click",()=>d.toggle()))}});document.body.addEventListener("htmx:beforeRequest",n=>{n.detail.elt.dataset.showLoading!=="false"&&(n.detail._loadingToast=r.info("Loading...",0))});document.body.addEventListener("htmx:afterRequest",n=>{n.detail._loadingToast&&r.remove(n.detail._loadingToast),n.detail.successful?n.detail.elt.dataset.successMessage&&r.success(n.detail.elt.dataset.successMessage):r.error("Request failed. Please try again.")});window.aiMate={toast:r,voiceAssistant:l,themeManager:d,StorageManager:c};
